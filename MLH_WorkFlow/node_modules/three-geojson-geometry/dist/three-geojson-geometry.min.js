// Version 1.3.1 three-geojson-geometry - https://github.com/vasturiano/three-geojson-geometry
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],n):n((t="undefined"!=typeof globalThis?globalThis:t||self).THREE=t.THREE||{},t.THREE)}(this,(function(t,n){"use strict";function e(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,o=void 0,"symbol"==typeof(o=function(t,n){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,n||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(i,"string"))?o:String(o)),r)}var i,o}function r(t){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},r(t)}function i(t,n){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},i(t,n)}function o(t,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var e,i=r(t);if(n){var u=r(this).constructor;e=Reflect.construct(i,arguments,u)}else e=i.apply(this,arguments);return o(this,e)}}function f(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,i,o,u,f=[],a=!0,c=!1;try{if(o=(e=e.call(t)).next,0===n){if(Object(e)!==e)return;a=!1}else for(;!(a=(r=o.call(e)).done)&&(f.push(r.value),f.length!==n);a=!0);}catch(t){c=!0,i=t}finally{try{if(!a&&null!=e.return&&(u=e.return(),Object(u)!==u))return}finally{if(c)throw i}}return f}}(t,n)||a(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,n){if(t){if("string"==typeof t)return c(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?c(t,n):void 0}}function c(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var l={};function s(t,n,e){e=e||2;var r,i,o,u,f,a,c,l=n&&n.length,s=l?n[0]*e:t.length,x=v(t,0,s,e,!0),h=[];if(!x||x.next===x.prev)return h;if(l&&(x=function(t,n,e,r){var i,o,u,f=[];for(i=0,o=n.length;i<o;i++)(u=v(t,n[i]*r,i<o-1?n[i+1]*r:t.length,r,!1))===u.next&&(u.steiner=!0),f.push(E(u));for(f.sort(b),i=0;i<f.length;i++)e=m(f[i],e);return e}(t,n,x,e)),t.length>80*e){r=o=t[0],i=u=t[1];for(var y=e;y<s;y+=e)(f=t[y])<r&&(r=f),(a=t[y+1])<i&&(i=a),f>o&&(o=f),a>u&&(u=a);c=0!==(c=Math.max(o-r,u-i))?32767/c:0}return p(x,h,e,r,i,c,0),h}function v(t,n,e,r,i){var o,u;if(i===B(t,n,e,r)>0)for(o=n;o<e;o+=r)u=G(o,t[o],t[o+1],u);else for(o=e-r;o>=n;o-=r)u=G(o,t[o],t[o+1],u);return u&&O(u,u.next)&&(I(u),u=u.next),u}function x(t,n){if(!t)return t;n||(n=t);var e,r=t;do{if(e=!1,r.steiner||!O(r,r.next)&&0!==S(r.prev,r,r.next))r=r.next;else{if(I(r),(r=n=r.prev)===r.next)break;e=!0}}while(e||r!==n);return n}function p(t,n,e,r,i,o,u){if(t){!u&&o&&function(t,n,e,r){var i=t;do{0===i.z&&(i.z=M(i.x,i.y,n,e,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,function(t){var n,e,r,i,o,u,f,a,c=1;do{for(e=t,t=null,o=null,u=0;e;){for(u++,r=e,f=0,n=0;n<c&&(f++,r=r.nextZ);n++);for(a=c;f>0||a>0&&r;)0!==f&&(0===a||!r||e.z<=r.z)?(i=e,e=e.nextZ,f--):(i=r,r=r.nextZ,a--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;e=r}o.nextZ=null,c*=2}while(u>1)}(i)}(t,r,i,o);for(var f,a,c=t;t.prev!==t.next;)if(f=t.prev,a=t.next,o?y(t,r,i,o):h(t))n.push(f.i/e|0),n.push(t.i/e|0),n.push(a.i/e|0),I(t),t=a.next,c=a.next;else if((t=a)===c){u?1===u?p(t=d(x(t),n,e),n,e,r,i,o,2):2===u&&g(t,n,e,r,i,o):p(x(t),n,e,r,i,o,1);break}}}function h(t){var n=t.prev,e=t,r=t.next;if(S(n,e,r)>=0)return!1;for(var i=n.x,o=e.x,u=r.x,f=n.y,a=e.y,c=r.y,l=i<o?i<u?i:u:o<u?o:u,s=f<a?f<c?f:c:a<c?a:c,v=i>o?i>u?i:u:o>u?o:u,x=f>a?f>c?f:c:a>c?a:c,p=r.next;p!==n;){if(p.x>=l&&p.x<=v&&p.y>=s&&p.y<=x&&Z(i,f,o,a,u,c,p.x,p.y)&&S(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function y(t,n,e,r){var i=t.prev,o=t,u=t.next;if(S(i,o,u)>=0)return!1;for(var f=i.x,a=o.x,c=u.x,l=i.y,s=o.y,v=u.y,x=f<a?f<c?f:c:a<c?a:c,p=l<s?l<v?l:v:s<v?s:v,h=f>a?f>c?f:c:a>c?a:c,y=l>s?l>v?l:v:s>v?s:v,d=M(x,p,n,e,r),g=M(h,y,n,e,r),b=t.prevZ,m=t.nextZ;b&&b.z>=d&&m&&m.z<=g;){if(b.x>=x&&b.x<=h&&b.y>=p&&b.y<=y&&b!==i&&b!==u&&Z(f,l,a,s,c,v,b.x,b.y)&&S(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,m.x>=x&&m.x<=h&&m.y>=p&&m.y<=y&&m!==i&&m!==u&&Z(f,l,a,s,c,v,m.x,m.y)&&S(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;b&&b.z>=d;){if(b.x>=x&&b.x<=h&&b.y>=p&&b.y<=y&&b!==i&&b!==u&&Z(f,l,a,s,c,v,b.x,b.y)&&S(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;m&&m.z<=g;){if(m.x>=x&&m.x<=h&&m.y>=p&&m.y<=y&&m!==i&&m!==u&&Z(f,l,a,s,c,v,m.x,m.y)&&S(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function d(t,n,e){var r=t;do{var i=r.prev,o=r.next.next;!O(i,o)&&j(i,r,r.next,o)&&T(i,o)&&T(o,i)&&(n.push(i.i/e|0),n.push(r.i/e|0),n.push(o.i/e|0),I(r),I(r.next),r=t=o),r=r.next}while(r!==t);return x(r)}function g(t,n,e,r,i,o){var u=t;do{for(var f=u.next.next;f!==u.prev;){if(u.i!==f.i&&P(u,f)){var a=R(u,f);return u=x(u,u.next),a=x(a,a.next),p(u,n,e,r,i,o,0),void p(a,n,e,r,i,o,0)}f=f.next}u=u.next}while(u!==t)}function b(t,n){return t.x-n.x}function m(t,n){var e=function(t,n){var e,r=n,i=t.x,o=t.y,u=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var f=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(f<=i&&f>u&&(u=f,e=r.x<r.next.x?r:r.next,f===i))return e}r=r.next}while(r!==n);if(!e)return null;var a,c=e,l=e.x,s=e.y,v=1/0;r=e;do{i>=r.x&&r.x>=l&&i!==r.x&&Z(o<s?i:u,o,l,s,o<s?u:i,o,r.x,r.y)&&(a=Math.abs(o-r.y)/(i-r.x),T(r,t)&&(a<v||a===v&&(r.x>e.x||r.x===e.x&&w(e,r)))&&(e=r,v=a)),r=r.next}while(r!==c);return e}(t,n);if(!e)return n;var r=R(e,t);return x(r,r.next),x(e,e.next)}function w(t,n){return S(t.prev,t,n.prev)<0&&S(n.next,t,t.next)<0}function M(t,n,e,r,i){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-e)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-r)*i|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function E(t){var n=t,e=t;do{(n.x<e.x||n.x===e.x&&n.y<e.y)&&(e=n),n=n.next}while(n!==t);return e}function Z(t,n,e,r,i,o,u,f){return(i-u)*(n-f)>=(t-u)*(o-f)&&(t-u)*(r-f)>=(e-u)*(n-f)&&(e-u)*(o-f)>=(i-u)*(r-f)}function P(t,n){return t.next.i!==n.i&&t.prev.i!==n.i&&!function(t,n){var e=t;do{if(e.i!==t.i&&e.next.i!==t.i&&e.i!==n.i&&e.next.i!==n.i&&j(e,e.next,t,n))return!0;e=e.next}while(e!==t);return!1}(t,n)&&(T(t,n)&&T(n,t)&&function(t,n){var e=t,r=!1,i=(t.x+n.x)/2,o=(t.y+n.y)/2;do{e.y>o!=e.next.y>o&&e.next.y!==e.y&&i<(e.next.x-e.x)*(o-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next}while(e!==t);return r}(t,n)&&(S(t.prev,t,n.prev)||S(t,n.prev,n))||O(t,n)&&S(t.prev,t,t.next)>0&&S(n.prev,n,n.next)>0)}function S(t,n,e){return(n.y-t.y)*(e.x-n.x)-(n.x-t.x)*(e.y-n.y)}function O(t,n){return t.x===n.x&&t.y===n.y}function j(t,n,e,r){var i=_(S(t,n,e)),o=_(S(t,n,r)),u=_(S(e,r,t)),f=_(S(e,r,n));return i!==o&&u!==f||(!(0!==i||!A(t,e,n))||(!(0!==o||!A(t,r,n))||(!(0!==u||!A(e,t,r))||!(0!==f||!A(e,n,r)))))}function A(t,n,e){return n.x<=Math.max(t.x,e.x)&&n.x>=Math.min(t.x,e.x)&&n.y<=Math.max(t.y,e.y)&&n.y>=Math.min(t.y,e.y)}function _(t){return t>0?1:t<0?-1:0}function T(t,n){return S(t.prev,t,t.next)<0?S(t,n,t.next)>=0&&S(t,t.prev,n)>=0:S(t,n,t.prev)<0||S(t,t.next,n)<0}function R(t,n){var e=new z(t.i,t.x,t.y),r=new z(n.i,n.x,n.y),i=t.next,o=n.prev;return t.next=n,n.prev=t,e.next=i,i.prev=e,r.next=e,e.prev=r,o.next=r,r.prev=o,r}function G(t,n,e,r){var i=new z(t,n,e);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function I(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function z(t,n,e){this.i=t,this.x=n,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function B(t,n,e,r){for(var i=0,o=n,u=e-r;o<e;o+=r)i+=(t[u]-t[o])*(t[o+1]+t[u+1]),u=o;return i}({get exports(){return l},set exports(t){l=t}}).exports=s,l.default=s,s.deviation=function(t,n,e,r){var i=n&&n.length,o=i?n[0]*e:t.length,u=Math.abs(B(t,0,o,e));if(i)for(var f=0,a=n.length;f<a;f++){var c=n[f]*e,l=f<a-1?n[f+1]*e:t.length;u-=Math.abs(B(t,c,l,e))}var s=0;for(f=0;f<r.length;f+=3){var v=r[f]*e,x=r[f+1]*e,p=r[f+2]*e;s+=Math.abs((t[v]-t[p])*(t[x+1]-t[v+1])-(t[v]-t[x])*(t[p+1]-t[v+1]))}return 0===u&&0===s?0:Math.abs((s-u)/u)},s.flatten=function(t){for(var n=t[0][0].length,e={vertices:[],holes:[],dimensions:n},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var u=0;u<n;u++)e.vertices.push(t[i][o][u]);i>0&&(r+=t[i-1].length,e.holes.push(r))}return e};class F{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let e=0;for(let r=0;r<this._n&&r<32;r++){const i=n[r],o=t+i,u=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);u&&(n[e++]=u),t=o}return n[e]=t,this._n=e+1,this}valueOf(){const t=this._partials;let n,e,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(n=o,e=t[--i],o=n+e,r=e-(o-n),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(e=2*r,n=o+e,e==n-o&&(o=n))}return o}}var H=Math.PI,L=H/2,C=180/H,k=H/180,J=Math.abs,q=Math.atan2,D=Math.cos,N=Math.sin,U=Math.sqrt;function $(t){return(t=N(t/2))*t}function K(){}function Q(t,n){t&&nt.hasOwnProperty(t.type)&&nt[t.type](t,n)}var V,W,X,Y,tt={Feature:function(t,n){Q(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,i=e.length;++r<i;)Q(e[r].geometry,n)}},nt={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){et(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)et(e[r],n,0)},Polygon:function(t,n){rt(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)rt(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,i=e.length;++r<i;)Q(e[r],n)}};function et(t,n,e){var r,i=-1,o=t.length-e;for(n.lineStart();++i<o;)r=t[i],n.point(r[0],r[1],r[2]);n.lineEnd()}function rt(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)et(t[e],n,1);n.polygonEnd()}var it={sphere:K,point:K,lineStart:function(){it.point=ut,it.lineEnd=ot},lineEnd:K,polygonStart:K,polygonEnd:K};function ot(){it.point=it.lineEnd=K}function ut(t,n){W=t*=k,X=N(n*=k),Y=D(n),it.point=ft}function ft(t,n){t*=k;var e=N(n*=k),r=D(n),i=J(t-W),o=D(i),u=r*N(i),f=Y*e-X*r*o,a=X*e+Y*r*o;V.add(q(U(u*u+f*f),a)),W=t,X=e,Y=r}function at(t){return V=new F,function(t,n){t&&tt.hasOwnProperty(t.type)?tt[t.type](t,n):Q(t,n)}(t,it),+V}var ct=[null,null],lt={type:"LineString",coordinates:ct};function st(t,n){var e,r=t[0]*k,i=t[1]*k,o=n[0]*k,u=n[1]*k,f=D(i),a=N(i),c=D(u),l=N(u),s=f*D(r),v=f*N(r),x=c*D(o),p=c*N(o),h=2*((e=U($(u-i)+f*c*$(o-r)))>1?L:e<-1?-L:Math.asin(e)),y=N(h),d=h?function(t){var n=N(t*=h)/y,e=N(h-t)/y,r=e*s+n*x,i=e*v+n*p,o=e*a+n*l;return[q(i,r)*C,q(o,U(r*r+i*i))*C]}:function(){return[r*C,i*C]};return d.distance=h,d}var vt=function(){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[],e=null;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(r){if(e){var i=180*(a=r,c=e,ct[0]=a,ct[1]=c,at(lt))/Math.PI;if(i>t)for(var o=st(e,r),u=1/Math.ceil(i/t),f=u;f<1;)n.push(o(f)),f+=u}var a,c;n.push(e=r)})),n},xt="undefined"!=typeof window&&window.THREE?window.THREE:{BufferGeometry:n.BufferGeometry,Float32BufferAttribute:n.Float32BufferAttribute},pt=(new xt.BufferGeometry).setAttribute?"setAttribute":"addAttribute",ht=function(t){!function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&i(t,n)}(c,t);var n,r,o,a=u(c);function c(t){var n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,c),(n=a.call(this)).type="GeoJsonGeometry",n.parameters={geoJson:t,radius:e,resolution:r};var i=({Point:v,MultiPoint:function(t,n){var e={vertices:[],indices:[]};return t.map((function(t){return v(t,n)})).forEach((function(t){var n=f(t,1)[0];yt(e,n)})),[e]},LineString:x,MultiLineString:function(t,n){var e={vertices:[],indices:[]};return t.map((function(t){return x(t,n)})).forEach((function(t){var n=f(t,1)[0];yt(e,n)})),[e]},Polygon:p,MultiPolygon:function(t,n){var e={vertices:[],indices:[]},r={vertices:[],indices:[]};t.map((function(t){return p(t,n)})).forEach((function(t){var n=f(t,2),i=n[0],o=n[1];yt(e,i),o&&yt(r,o)}));var i=[e];return r.vertices.length&&i.push(r),i}}[t.type]||function(){return[]})(t.coordinates,e),o=[],u=[],s=0;function v(t,n){return[{vertices:gt(t[1],t[0],n),indices:[]}]}function x(t,n){for(var e=vt(t,r).map((function(t){var e=f(t,2),r=e[0];return gt(e[1],r,n)})),i=l.flatten([e]).vertices,o=Math.round(i.length/3),u=[],a=1;a<o;a++)u.push(a-1,a);return[{vertices:i,indices:u}]}function p(t,n){for(var e=t.map((function(t){return vt(t,r).map((function(t){var e=f(t,2),r=e[0];return gt(e[1],r,n)}))})),i=l.flatten(e),o=i.vertices,u=i.holes,a=u[0]||1/0,c=o.slice(0,3*a),s=o.slice(3*a),v=new Set(u),x=Math.round(o.length/3),p=[],h=[],y=1;y<x;y++)v.has(y)||(y<a?p.push(y-1,y):h.push(y-1-a,y-a));var d=[{indices:p,vertices:c}];return u.length&&d.push({indices:h,vertices:s}),d}return i.forEach((function(t){var e=o.length;yt({indices:o,vertices:u},t),n.addGroup(e,o.length-e,s++)})),o.length&&n.setIndex(o),u.length&&n[pt]("position",new xt.Float32BufferAttribute(u,3)),n}return n=c,r&&e(n.prototype,r),o&&e(n,o),Object.defineProperty(n,"prototype",{writable:!1}),n}(xt.BufferGeometry);function yt(t,n){var e=Math.round(t.vertices.length/3);dt(t.vertices,n.vertices),dt(t.indices,n.indices.map((function(t){return t+e})))}function dt(t,n){var e,r=function(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=a(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,f=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return u=t.done,t},e:function(t){f=!0,o=t},f:function(){try{u||null==e.return||e.return()}finally{if(f)throw o}}}}(n);try{for(r.s();!(e=r.n()).done;){var i=e.value;t.push(i)}}catch(t){r.e(t)}finally{r.f()}}function gt(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=(90-t)*Math.PI/180,i=(90-n)*Math.PI/180;return[e*Math.sin(r)*Math.cos(i),e*Math.cos(r),e*Math.sin(r)*Math.sin(i)]}t.GeoJsonGeometry=ht}));
